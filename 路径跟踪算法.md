# 路径跟踪

> 应用LTE的路径积分形式，可以设计 path trace 渲染算法。

由之前的结论，得知：

$$L(p_1 -> p_0) = \Sigma_{i=1}^\infty P(p_n)$$
($$p_0$$在相机处，$$p_1$$是到达场景中的第一个交点)

问题：

1. 如何通过有限项的和计算级数的和？
2. 如何生成某个特定的路径$$p_i$$?

第一个问题可以通过Russian routlette 方法解决，每个step后以$$q_i$$的概率终止(不终止的概率为$$1-q_i$$).

$$\Sigma_{i=1}^\infty P(p_n) = \frac{1}{1-q_1} (P(p_1) + \frac{1}{1-q_2} (...))$$

这样有限步和的期望就是原级数的和。


第二个问题，可以通过路径采样生成路径，然后在该路径上计算$$P(p_i)$$。生成路径，相当于从场景中均匀采样i个点（从$$p_0$$ 到 $$p_{i-1}$$）, 然后从光源中采样$$P_i$$,这样就得到了要求的路径。该路径拥有求值需要的所有值，可以根据这些值来求解。

在场景中均匀采点的方法：第i个物体的面积为$$A_i$$，则在该物体表面采点的概率设置为$$A_i / \Sigma_j A_j$$。 在物体表面均匀采样，因此每一点采样的概率为$$1/ A_i$$，二者相乘得到每个点的采样概率为$$1/\Sigma_j A_j$$是常数，因此这样的采样策略是可行的。

## 渐进式路径构造



