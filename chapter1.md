# Metropolis Sampling 算法

## 马尔科夫链及平稳分布

马尔科夫链： 下一个状态只取决于当前状态。

根据马尔科夫链定理，从初始概率 $$\pi_0$$ 出发，在马尔科夫链上做状态转移，$$\pi_i$$将会收敛到$$\pi_n$$,则之后的$$\pi_{n+1}、 \pi_{n+2} $$ 均等于$$\pi_n$$,也就是说，之后的采样是稳定分布的样本。

## Metropolis 采样算法

思路：
构造马尔科夫链的转移概率矩阵，使得该马尔科夫链收敛后的平稳分布为$$p(x)$$(我们要采样的分布)

### 细致平稳条件
若转移概率矩阵P和分布$$\pi(x)$$满足：

$$\pi(i) P_{ij} = \pi(j) P_{ji}$$ for all i,j , 则$$\pi(x)$$ 是其平稳分布。
然而一般情况下，该条件并不成立。

在两侧引入接受率使之成立：
$$\pi(i) P_{ij} \alpha_{ij} = \pi(j) P_{ji} \alpha_{ji}$$

根据对称性，$$\alpha可按照下式初始化：$$
$$\alpha_{ij} = \pi(j) P_{ji}, \alpha_{ji} = \pi(i) P_{ij}$$


$$\alpha_{ij} = min \{ \frac{\pi_j P_{ji}}{\pi_i P_{ij}},1\}$$

### 采样过程

- 初始化 状态为 $$x_o$$
- 循环以下步骤：
    - t时刻，在$$P_{x,x_t}$$中采样,得到y
    - 从均匀分布中采样$$u \in [0,1]$$
    - 若$$u < \alpha_{x_t, y}$$, 则进行转移,$$x_{t+1} = y$$
    - 否则，不进行转移，$$x_{t+1} = x_t$$


 

